# 2017 SoongsilCTF (고등부) - [Reversing] Reversing2
## Problem
```
새로운 통과암호가 내려왔다.
왁찐은 꺼두시게
```
## Solution
똑같이 IDA 로 메인코드를 열어봅시다.
```
int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v4; // [sp+1Ch] [bp-4h]@1

  __main();
  puts("\n  ---------------------------------------------------------------------");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                         ver.5.0   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                         N국 지령 전달기                           ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  puts(" ㅣ                                                                   ㅣ");
  printf(" ㅣ                                                 made by LGM       ㅣ");
  puts("\n  ---------------------------------------------------------------------");
  putchar(10);
  puts("이전 통과암호를 입력하시오 ");
  scanf("%d", &v4);
  if ( v4 == 76854125 )
  {
    puts("\n  ---------------------------------------------------------------------");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                         ver.5.0   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                          통과암호는                               ㅣ");
    puts(" ㅣ                   이전 통과함호의 각 자리에                       ㅣ");
    puts(" ㅣ                      1씩 빼면 된다네...                           ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    printf(" ㅣ                                                 made by LGM       ㅣ");
    puts("\n  ---------------------------------------------------------------------");
  }
  if ( v4 != 76854125 )
  {
    puts("\n  ---------------------------------------------------------------------");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                         ver.4.0   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                           ........                                ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    puts(" ㅣ                                                                   ㅣ");
    printf(" ㅣ                                                 made by LGM       ㅣ");
    puts("\n  ---------------------------------------------------------------------");
  }
  system("PAUSE");
  return 0;
}
```
`76854125` 에서 각 자리에서 1씩 빼주면 됩니다.

최종 플래그는 `65743014`